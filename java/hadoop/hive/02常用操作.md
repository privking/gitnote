# HIVE常用操作

# hive hql

### 显示数据库

```sql
show databases;
```

### 使用默认数据库

```sql
use default;
```

### 删除创建的表

```sql
drop table student;
```

### 创建表并指定分隔符

```sql
create table student(id int,name string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
```

### 查询表结构

```sql
show create table student;
```

### 查询库信息

```sql
desc database xxx;
desc database extended xxx; --详细信息
```

### 查询表信息

```sql
desc 表名;
desc formatted 表名;
desc extended 表名;
```

### 创建表

```
CREATE [EXTERNAL] TABLE [IF NOT EXISTS] table_name 
[(col_name data_type [COMMENT col_comment], ...)]   --表中的字段信息
[COMMENT table_comment] --表的注释

[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] 
[CLUSTERED BY (col_name, col_name, ...) 
[SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS] 

[ROW FORMAT row_format]  --表中数据每行的格式，定义数据字段的分隔符，集合元素的分隔符等

[STORED AS file_format] --表中的数据要以哪种文件格式来存储，默认为TEXTFILE（文本文件）
					    --可以设置为SequnceFile或 Paquret,ORC等
[LOCATION hdfs_path] --表在hdfs上的位置
```

EXTERNAL:  

- 不带EXTERNAL 是一个MANAGED_TABLE （管理表，内部表）
- 带EXTERNAL 是一个外部表
- 内部表(管理表)在执行删除操作时，会将表的元数据(schema)和表位置的数据一起删除！
- 外部表在执行删除表操作时，只删除表的元数据(schema)
- 转换：`alter table p1 set tblproperties('EXTERNAL'='TRUE');`

### 查询

```sql
select * from student
```

### 插入

```sql
insert ...
```

### 上传文件

```
# 1. 直接上传到hdfs对应表目录下
# 2. load
load data local inpath '/xxxx/xxx' into table student
```



## 在HIVE CLI模式下

* 可以直接操作hdfs

```sh
hive> dfs -ls /
```

* 操作linux

```sh
hive>!ls /
```

